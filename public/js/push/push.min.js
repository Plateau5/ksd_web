$(function(a){windowInFocus();getMessagesInfo("#header_messages")});var Cookie={set:function(b,c,a,e,f){var d=new Date();d.setDate(d.getDate()+a);document.cookie=b+"="+escape(c)+((a==null)?"":";expires="+d.toGMTString())+";"+((e==null)?"":"path="+escape(e));if(typeof f=="function"){f&&f()}},del:function(a,d){var c=new Date();c.setTime(c.getTime()-1);var b=getCookie(a);if(b!=null){document.cookie=a+"="+b+";expires="+c.toGMTString()}if(typeof d=="function"){d&&d()}},get:function(b,d){if(document.cookie.length>0){var a,c=new RegExp("(^| )"+b+"=([^;]*)(;|$)");if(a=document.cookie.match(c)){return a[2]}else{return null}}if(typeof d=="function"){d&&d()}}};var WINDOWFOCUS=true;function windowInFocus(){$(window).on("focus",function(){WINDOWFOCUS=true});$(window).on("blur",function(){WINDOWFOCUS=false});return true}function getMessagesInfo(selector){if(!selector){return}else{if(typeof selector!="string"){console.log("The parameters of 'selector''s type must be a string.");return}}var cookieValue=Cookie.get("logininfo");var getMessages=function(){var newMessage=0;$.post(contextPath+"/api/message/getNotice?query_type=1",function(datas){var data=eval(datas);if(data.error_code==0){if(data.count>"0"){newMessage=data.count;$(selector).addClass("active");$(".message_count").find("span").text(data.count).end().show();$(".message_tip").show().find(".count").text(data.count);var timer=setTimeout(function(){$(".message_tip").hide();clearTimeout(timer)},5000);if(!WINDOWFOCUS){messageNotification("å¿«æ”¶å?","æ‚¨æœ‰"+data.count+"æ¡å¾…å¤„ç†äº‹é¡¹",contextPath+"/message/getList",contextPath+"/static/icon/kuaisd_m_logo.png")}}else{if(data.count=="0"){$(selector).removeClass("active");$(".message_count ").hide().find("span").text("");$(".message_tip").hide().find(".count").text("")}}}else{if(data.error_code==800){alert("ç™»å½•å¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•");window.location.href=contextPath+"/login/logout"}else{alert(data.error_msg)}}});return newMessage};getMessages();setInterval(function(){getMessages()},300000)}function messageNotification(e,a,b,d){if(!!e){if(typeof e!="string"){throw new Error("The parameter of 'title''s type must be a string.");return}}else{throw new Error("The parameter of 'title' is not defined.")}if(!!a){if(typeof a!="string"){throw new Error("The parameter of 'showDetailInfo''s type must be a string.");return}}else{throw new Error("The parameter of 'showDetailInfo' is not defined.")}if(!!b){if(typeof b!="string"){throw new Error("The parameter of 'href''s type must be a string.");return}}else{throw new Error("The parameter of 'href' is not defined.")}if(!!d){if(typeof d!="string"){throw new Error("The parameter of 'icon''s type must be a string.");return}}else{throw new Error("The parameter of 'icon' is not defined.")}var c={isNotificationSupported:"Notification" in window,isPermissionGranted:function(){return Notification.permission==="granted"},requestPermission:function(){if(!this.isNotificationSupported){alert("è¯¥æµè§ˆå™¨ç›®å‰ä¸æ”¯æŒæ¶ˆæ¯æ¨é€ï¼Œè¯·æ›´æ¢Chromeæµè§ˆå™¨æ‰“å¼?");return}Notification.requestPermission(function(f){})},showNotification:function(){if(!this.isNotificationSupported){alert("è¯¥æµè§ˆå™¨ç›®å‰ä¸æ”¯æŒæ¶ˆæ¯æ¨é€ï¼Œè¯·æ›´æ¢Chromeæµè§ˆå™¨æ‰“å¼?");return}if(!this.isPermissionGranted()){this.requestPermission()}var f=new Notification(e,{tag:1,renotify:true,requireInteraction:true,icon:d,body:a});f.onclick=function(){window.location.href=b;f.close()};f.onerror=function(){console.log("Notification encounters an error.")}}};return c.showNotification()}function bindEvents(b,a,d){if(!b||!a){console.log("The parameters of 'type' or 'selector' is not defined.");return false}else{if(typeof b!="string"){console.log("The parameters of 'selector''s type must be a string.");return false}if(typeof a!="string"){console.log("The parameters of 'selector''s type must be a string.");return false}}if(!!d&&typeof d!="function"){console.log("The parameters of 'callback' is not defined or it's type is not a function.")}var c=$(a);c.off(b).on(b,function(f){var f=f||window.event;d&&d(f)})}function pageJump(a,d){var b={};if(d){b=$.extend({},d)}var c=$(a);c.off("click").on("click",function(){var g=$(this);var e=$.trim(g.data("id"));var h=$.trim(g.data("flow_id"));var f=$.trim(g.data("url"));e&&(b.finance_id=e);h&&(b.id=h);locationTo({action:f,param:b})})};